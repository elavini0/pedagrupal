<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cuestionario de Evaluación Pedagógica - Recrearte</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
/* Reset y configuración base */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
    color: #333;
    background: linear-gradient(135deg, #e3f2fd 0%, #f8f9fa 100%);
    min-height: 100vh;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    background: white;
    min-height: 100vh;
    box-shadow: 0 0 20px rgba(0,0,0,0.1);
}

/* Header */
.header {
    background: linear-gradient(135deg, #00bcd4 0%, #4caf50 25%, #ff9800 50%, #f44336 75%, #9c27b0 100%);
    padding: 20px;
    color: white;
    position: relative;
    overflow: hidden;
}

.header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
}

.header > * {
    position: relative;
    z-index: 2;
}

.logo-section {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 15px;
}

.logo-recrearte {
    display: flex;
    align-items: center;
    gap: 20px;
}

.logo-image {
    height: 60px;
    width: auto;
    filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.3));
}

.page-title {
    font-size: 24px;
    font-weight: 400;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    color: white;
}

.date-section {
    margin-bottom: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 15px;
}

.date-section label {
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 10px;
}

.date-section input {
    padding: 8px 12px;
    border: none;
    border-radius: 5px;
    font-size: 14px;
}

.btn-clear {
    background: #dc3545;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 500;
    transition: all 0.3s ease;
}

.btn-clear:hover {
    background: #c82333;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(220,53,69,0.3);
}

/* Progress Bar */
.progress-bar {
    width: 100%;
    height: 8px;
    background: rgba(255,255,255,0.3);
    border-radius: 4px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #4caf50, #00bcd4);
    width: 8.33%;
    transition: width 0.3s ease;
    border-radius: 4px;
}

/* Main Content */
.main-content {
    display: flex;
    min-height: calc(100vh - 200px);
}

/* Sidebar */
.sidebar {
    width: 280px;
    background: #f8f9fa;
    border-right: 1px solid #e9ecef;
    position: relative;
}

.nav-toggle {
    display: none;
    padding: 15px;
    cursor: pointer;
    font-size: 20px;
    background: #007bff;
    color: white;
    text-align: center;
}

.nav-menu {
    list-style: none;
    padding: 20px 0;
}

.nav-menu li {
    margin: 0;
}

.nav-link {
    display: block;
    padding: 12px 20px;
    text-decoration: none;
    color: #495057;
    transition: all 0.3s ease;
    border-left: 4px solid transparent;
}

.nav-link:hover {
    background: #e9ecef;
    color: #007bff;
    border-left-color: #007bff;
}

.nav-link.active {
    background: #007bff;
    color: white;
    border-left-color: #0056b3;
}

/* Form Content */
.form-content {
    flex: 1;
    padding: 30px;
    overflow-y: auto;
}

.form-section {
    display: none;
    animation: fadeIn 0.3s ease;
}

.form-section.active {
    display: block;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.form-section h3 {
    color: #007bff;
    margin-bottom: 25px;
    padding-bottom: 10px;
    border-bottom: 2px solid #e9ecef;
    font-size: 24px;
}

.form-section h4 {
    color: #495057;
    margin: 20px 0 15px 0;
    font-size: 18px;
}

/* Form Groups */
.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: #495057;
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 12px;
    border: 2px solid #e9ecef;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
    outline: none;
    border-color: #007bff;
    box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
}

.form-group input:required:invalid {
    border-color: #dc3545;
}

.form-group input:required:valid {
    border-color: #28a745;
}

/* Grid Layouts */
.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.form-group.full-width {
    grid-column: 1 / -1;
}

.vitales-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
}

.antropometria-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

/* Radio Groups */
.radio-group {
    display: flex;
    gap: 20px;
    margin-top: 10px;
}

.radio-group label {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: normal;
    cursor: pointer;
}

/* Table Styles */
.table-container {
    overflow-x: auto;
    margin: 20px 0;
}

#grupoFamiliarTable {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 15px;
}

#grupoFamiliarTable th,
#grupoFamiliarTable td {
    padding: 12px;
    text-align: left;
    border: 1px solid #e9ecef;
}

#grupoFamiliarTable th {
    background: #f8f9fa;
    font-weight: 600;
    color: #495057;
}

#grupoFamiliarTable input {
    width: 100%;
    padding: 8px;
    border: 1px solid #e9ecef;
    border-radius: 4px;
}

/* Buttons */
.btn {
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-block;
    text-align: center;
}

.btn-primary {
    background: #007bff;
    color: white;
}

.btn-primary:hover {
    background: #0056b3;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,123,255,0.3);
}

.btn-secondary {
    background: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background: #545b62;
    transform: translateY(-2px);
}

.btn-success {
    background: #28a745;
    color: white;
}

.btn-success:hover {
    background: #1e7e34;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(40,167,69,0.3);
}

.btn-add {
    background: #28a745;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
}

.btn-add:hover {
    background: #1e7e34;
}

.btn-remove {
    background: #dc3545;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
}

.btn-remove:hover {
    background: #c82333;
}

/* Navigation Buttons */
.navigation-buttons {
    display: flex;
    justify-content: space-between;
    margin-top: 40px;
    padding-top: 20px;
    border-top: 1px solid #e9ecef;
}

/* Examen Subsections */
.examen-subsection {
    margin-bottom: 30px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #007bff;
}

/* Firma Section */
.firma-section {
    margin-top: 40px;
    text-align: right;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 8px;
}

.firma {
    font-size: 16px;
    color: #495057;
    line-height: 1.4;
}

/* Responsive Design */
@media (max-width: 768px) {
    .main-content {
        flex-direction: column;
    }
    
    .sidebar {
        width: 100%;
        position: relative;
    }
    
    .nav-toggle {
        display: block;
    }
    
    .nav-menu {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: #f8f9fa;
        z-index: 1000;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .nav-menu.show {
        display: block;
    }
    
    .form-content {
        padding: 20px;
    }
    
    .form-grid {
        grid-template-columns: 1fr;
    }
    
    .vitales-grid,
    .antropometria-grid {
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    }
    
    .navigation-buttons {
        flex-direction: column;
        gap: 10px;
    }
    
    .logo-section {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }
    
    .page-title {
        font-size: 20px;
    }
}

@media (max-width: 480px) {
    .form-content {
        padding: 15px;
    }
    
    .header {
        padding: 15px;
    }
    
    .logo-text {
        font-size: 24px;
    }
    
    .page-title {
        font-size: 18px;
    }
    
    .table-container {
        font-size: 12px;
    }
    
    #grupoFamiliarTable th,
    #grupoFamiliarTable td {
        padding: 8px;
    }
}

/* Print Styles */
@media print {
    .sidebar,
    .navigation-buttons,
    .nav-toggle {
        display: none;
    }
    
    .main-content {
        flex-direction: column;
    }
    
    .form-content {
        padding: 0;
    }
    
    .form-section {
        display: block !important;
        page-break-inside: avoid;
        margin-bottom: 30px;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo-section">
                <div class="logo-recrearte">
                    <img src="logo_solo_sombra.png" alt="Logo Recrearte" class="logo-image" id="logoImage">
                    <h2 class="page-title">Cuestionario de Evaluación Pedagógica - Recrearte</h2>
                </div>
            </div>
            <div class="date-section">
                <label>Fecha: <input type="date" id="fecha" required></label>
                <button type="button" id="clearFormBtn" class="btn-clear">🗑️ Limpiar Formulario</button>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </header>

        <div class="main-content">
            <!-- Sidebar Navigation -->
            <nav class="sidebar" id="sidebar">
                <div class="nav-toggle" id="navToggle">☰</div>
                <ul class="nav-menu" id="navMenu">
                    <li><a href="#seccion1" class="nav-link active" data-section="1">Datos Generales</a></li>
                    <li><a href="#seccion2" class="nav-link" data-section="2">Área Cognitiva</a></li>
                    <li><a href="#seccion3" class="nav-link" data-section="3">Área Social y Emocional</a></li>
                    <li><a href="#seccion4" class="nav-link" data-section="4">Área Comunicacional</a></li>
                    <li><a href="#seccion5" class="nav-link" data-section="5">Área Creativa y Expresiva</a></li>
                    <li><a href="#seccion6" class="nav-link" data-section="6">Área Motriz</a></li>
                    <li><a href="#seccion7" class="nav-link" data-section="7">Motivación y Participación</a></li>
                    <li><a href="#seccion8" class="nav-link" data-section="8">Observaciones Generales</a></li>
                </ul>
            </nav>

            <!-- Form Content -->
            <main class="form-content">
                <form id="historiaClinicaForm">


                    
                    <!-- Sección 1: Datos Generales -->
                    <section class="form-section active" id="seccion1">
                        <h3>📘 Datos Generales del/la Participante</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="nombreCompleto">Nombre Completo *</label>
                                <input type="text" id="nombreCompleto" name="nombreCompleto" required>
                            </div>
                            <div class="form-group">
                                <label for="edad">Edad *</label>
                                <input type="number" id="edad" name="edad" required>
                            </div>
                            <div class="form-group full-width">
                                <label for="tipoDiscapacidad">Tipo de Discapacidad (si corresponde especificar)</label>
                                <input type="text" id="tipoDiscapacidad" name="tipoDiscapacidad" placeholder="Especificar si corresponde">
                            </div>
                            <div class="form-group">
                                <label for="nivelAutonomia">Nivel de Autonomía *</label>
                                <select id="nivelAutonomia" name="nivelAutonomia" required>
                                    <option value="">Seleccionar...</option>
                                    <option value="alta">Alta</option>
                                    <option value="media">Media</option>
                                    <option value="baja">Baja</option>
                                </select>
                            </div>
                            <div class="form-group full-width">
                                <label for="apoyosRequeridos">Apoyos Requeridos (técnicos, humanos, otros)</label>
                                <textarea id="apoyosRequeridos" name="apoyosRequeridos" rows="3" placeholder="Describir los apoyos necesarios..."></textarea>
                            </div>
                        </div>
                    </section>

                    <!-- Sección 2: Área Cognitiva -->
                    <section class="form-section" id="seccion2">
                        <h3>🧠 Área Cognitiva</h3>
                        <div class="form-group">
                            <label for="reconoceInstrucciones">¿Reconoce instrucciones simples y complejas?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="reconoceInstrucciones" value="si"> Sí</label>
                                <label><input type="radio" name="reconoceInstrucciones" value="parcialmente"> Parcialmente</label>
                                <label><input type="radio" name="reconoceInstrucciones" value="no"> No</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="resuelveProblemas">¿Resuelve situaciones cotidianas con ayuda o de forma autónoma?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="resuelveProblemas" value="autonomo"> Autónomo</label>
                                <label><input type="radio" name="resuelveProblemas" value="con_ayuda"> Con ayuda</label>
                                <label><input type="radio" name="resuelveProblemas" value="no_resuelve"> No resuelve</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="relacionesLogicas">¿Puede establecer relaciones lógicas entre conceptos o actividades?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="relacionesLogicas" value="si"> Sí</label>
                                <label><input type="radio" name="relacionesLogicas" value="parcialmente"> Parcialmente</label>
                                <label><input type="radio" name="relacionesLogicas" value="no"> No</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="observacionesCognitivas">Observaciones adicionales del área cognitiva</label>
                            <textarea id="observacionesCognitivas" name="observacionesCognitivas" rows="3" placeholder="Detalles específicos sobre el desempeño cognitivo..."></textarea>
                        </div>
                    </section>

                    <!-- Sección 3: Área Social y Emocional -->
                    <section class="form-section" id="seccion3">
                        <h3>🤝 Área Social y Emocional</h3>
                        <div class="form-group">
                            <label for="interactuaPares">¿Interactúa con sus pares durante las actividades?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="interactuaPares" value="siempre"> Siempre</label>
                                <label><input type="radio" name="interactuaPares" value="a_veces"> A veces</label>
                                <label><input type="radio" name="interactuaPares" value="raramente"> Raramente</label>
                                <label><input type="radio" name="interactuaPares" value="nunca"> Nunca</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="expresaEmociones">¿Expresa emociones o sentimientos frente a estímulos?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="expresaEmociones" value="claramente"> Claramente</label>
                                <label><input type="radio" name="expresaEmociones" value="parcialmente"> Parcialmente</label>
                                <label><input type="radio" name="expresaEmociones" value="dificultad"> Con dificultad</label>
                                <label><input type="radio" name="expresaEmociones" value="no_expresa"> No expresa</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="respetaTurnos">¿Respeta turnos y normas grupales?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="respetaTurnos" value="siempre"> Siempre</label>
                                <label><input type="radio" name="respetaTurnos" value="frecuentemente"> Frecuentemente</label>
                                <label><input type="radio" name="respetaTurnos" value="a_veces"> A veces</label>
                                <label><input type="radio" name="respetaTurnos" value="raramente"> Raramente</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="observacionesSociales">Observaciones adicionales del área social y emocional</label>
                            <textarea id="observacionesSociales" name="observacionesSociales" rows="3" placeholder="Detalles sobre interacciones sociales y expresión emocional..."></textarea>
                        </div>
                    </section>

                    <!-- Sección 4: Área Comunicacional -->
                    <section class="form-section" id="seccion4">
                        <h3>✍️ Área Comunicacional</h3>
                        <div class="form-group">
                            <label for="tipoLenguaje">¿Utiliza lenguaje verbal, gestual, pictográfico o asistido?</label>
                            <div class="form-group">
                                <label><input type="checkbox" name="lenguaje_verbal" value="1"> Verbal</label>
                                <label><input type="checkbox" name="lenguaje_gestual" value="1"> Gestual</label>
                                <label><input type="checkbox" name="lenguaje_pictografico" value="1"> Pictográfico</label>
                                <label><input type="checkbox" name="lenguaje_asistido" value="1"> Asistido</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="comprendeConsignas">¿Comprende consignas orales o escritas?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="comprendeConsignas" value="ambas"> Ambas</label>
                                <label><input type="radio" name="comprendeConsignas" value="solo_orales"> Solo orales</label>
                                <label><input type="radio" name="comprendeConsignas" value="solo_escritas"> Solo escritas</label>
                                <label><input type="radio" name="comprendeConsignas" value="ninguna"> Ninguna</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="comunicaEspontaneamente">¿Se comunica espontáneamente con docentes y compañeros?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="comunicaEspontaneamente" value="frecuentemente"> Frecuentemente</label>
                                <label><input type="radio" name="comunicaEspontaneamente" value="a_veces"> A veces</label>
                                <label><input type="radio" name="comunicaEspontaneamente" value="raramente"> Raramente</label>
                                <label><input type="radio" name="comunicaEspontaneamente" value="nunca"> Nunca</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="observacionesComunicacion">Observaciones adicionales del área comunicacional</label>
                            <textarea id="observacionesComunicacion" name="observacionesComunicacion" rows="3" placeholder="Detalles sobre formas de comunicación y comprensión..."></textarea>
                        </div>
                    </section>

                    <!-- Sección 5: Laboral y Educativo -->
                    <!-- Sección 5: Área Creativa y Expresiva -->
                    <section class="form-section" id="seccion5">
                        <h3>🎨 Área Creativa y Expresiva</h3>
                        <div class="form-group">
                            <label for="participaActividades">¿Participa activamente en actividades artísticas?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="participaActividades" value="muy_activo"> Muy activo</label>
                                <label><input type="radio" name="participaActividades" value="activo"> Activo</label>
                                <label><input type="radio" name="participaActividades" value="poco_activo"> Poco activo</label>
                                <label><input type="radio" name="participaActividades" value="pasivo"> Pasivo</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="exploraMateriales">¿Explora distintos materiales y formatos (dibujos, música, teatro)?</label>
                            <div class="form-group">
                                <label><input type="checkbox" name="explora_dibujos" value="1"> Dibujos</label>
                                <label><input type="checkbox" name="explora_musica" value="1"> Música</label>
                                <label><input type="checkbox" name="explora_teatro" value="1"> Teatro</label>
                                <label><input type="checkbox" name="explora_otros" value="1"> Otros</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="interesCreativo">¿Demuestra interés en expresarse a través de medios creativos?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="interesCreativo" value="mucho"> Mucho interés</label>
                                <label><input type="radio" name="interesCreativo" value="moderado"> Interés moderado</label>
                                <label><input type="radio" name="interesCreativo" value="poco"> Poco interés</label>
                                <label><input type="radio" name="interesCreativo" value="ninguno"> Sin interés</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="observacionesCreativas">Observaciones adicionales del área creativa y expresiva</label>
                            <textarea id="observacionesCreativas" name="observacionesCreativas" rows="3" placeholder="Detalles sobre expresión artística y creatividad..."></textarea>
                        </div>
                    </section>

                    <!-- Sección 6: Área Motriz -->
                    <section class="form-section" id="seccion6">
                        <h3>🕺 Área Motriz</h3>
                        <div class="form-group">
                            <label for="desplazamientoAutonomo">¿Se desplaza de forma autónoma dentro del espacio?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="desplazamientoAutonomo" value="totalmente"> Totalmente autónomo</label>
                                <label><input type="radio" name="desplazamientoAutonomo" value="con_apoyo"> Con apoyo ocasional</label>
                                <label><input type="radio" name="desplazamientoAutonomo" value="asistencia"> Requiere asistencia</label>
                                <label><input type="radio" name="desplazamientoAutonomo" value="no_autonomo"> No autónomo</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="coordinacionMovimientos">¿Coordina movimientos finos y gruesos según la actividad?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="coordinacionMovimientos" value="excelente"> Excelente coordinación</label>
                                <label><input type="radio" name="coordinacionMovimientos" value="buena"> Buena coordinación</label>
                                <label><input type="radio" name="coordinacionMovimientos" value="regular"> Coordinación regular</label>
                                <label><input type="radio" name="coordinacionMovimientos" value="dificultades"> Con dificultades</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="condicionFisica">¿Presenta alguna condición física que limite la participación?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="condicionFisica" value="no"> No</label>
                                <label><input type="radio" name="condicionFisica" value="leve"> Limitación leve</label>
                                <label><input type="radio" name="condicionFisica" value="moderada"> Limitación moderada</label>
                                <label><input type="radio" name="condicionFisica" value="severa"> Limitación severa</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="observacionesMotrices">Observaciones adicionales del área motriz</label>
                            <textarea id="observacionesMotrices" name="observacionesMotrices" rows="3" placeholder="Detalles sobre habilidades motrices y limitaciones físicas..."></textarea>
                        </div>
                    </section>

                    <!-- Sección 7: Motivación y Participación -->
                    <section class="form-section" id="seccion7">
                        <h3>🎯 Motivación y Participación</h3>
                        <div class="form-group">
                            <label for="involucramientoActividades">¿Se involucra en las actividades propuestas?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="involucramientoActividades" value="siempre"> Siempre</label>
                                <label><input type="radio" name="involucramientoActividades" value="frecuentemente"> Frecuentemente</label>
                                <label><input type="radio" name="involucramientoActividades" value="a_veces"> A veces</label>
                                <label><input type="radio" name="involucramientoActividades" value="raramente"> Raramente</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="aceptaDesafios">¿Acepta desafíos o se resiste a nuevas tareas?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="aceptaDesafios" value="acepta_siempre"> Acepta siempre</label>
                                <label><input type="radio" name="aceptaDesafios" value="acepta_frecuentemente"> Acepta frecuentemente</label>
                                <label><input type="radio" name="aceptaDesafios" value="acepta_a_veces"> Acepta a veces</label>
                                <label><input type="radio" name="aceptaDesafios" value="se_resiste"> Se resiste</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="preferenciaEspacios">¿Disfruta las instancias grupales o prefiere espacios individuales?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="preferenciaEspacios" value="grupales"> Prefiere grupales</label>
                                <label><input type="radio" name="preferenciaEspacios" value="ambos"> Disfruta ambos</label>
                                <label><input type="radio" name="preferenciaEspacios" value="individuales"> Prefiere individuales</label>
                                <label><input type="radio" name="preferenciaEspacios" value="evita_grupales"> Evita grupales</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="observacionesMotivacion">Observaciones adicionales sobre motivación y participación</label>
                            <textarea id="observacionesMotivacion" name="observacionesMotivacion" rows="3" placeholder="Detalles sobre nivel de motivación y participación..."></textarea>
                        </div>
                    </section>

                    <!-- Sección 8: Observaciones Generales -->
                    <section class="form-section" id="seccion8">
                        <h3>📝 Observaciones Generales</h3>
                        <div class="form-group">
                            <label for="fortalezasObservadas">Fortalezas Observadas</label>
                            <textarea id="fortalezasObservadas" name="fortalezasObservadas" rows="4" placeholder="Describir las principales fortalezas del participante..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="aspectosTrabajar">Aspectos a Trabajar</label>
                            <textarea id="aspectosTrabajar" name="aspectosTrabajar" rows="4" placeholder="Identificar áreas que requieren mayor atención o desarrollo..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="recomendacionesEspecificas">Recomendaciones Específicas</label>
                            <textarea id="recomendacionesEspecificas" name="recomendacionesEspecificas" rows="4" placeholder="Sugerencias específicas para el trabajo pedagógico..."></textarea>
                        </div>
                    </section>

                    <!-- Sección 9: Datos Vitales -->
                    <!-- Navigation Buttons -->
                    <div class="navigation-buttons">
                        <button type="button" id="prevBtn" class="btn btn-secondary">Anterior</button>
                        <button type="button" id="generatePdfBtn" class="btn btn-success">Generar PDF</button>
                        <button type="button" id="nextBtn" class="btn btn-primary">Siguiente</button>
                    </div>
                </form>
            </main>
        </div>
    </div>

    <script>
// Variables globales
let currentSection = 1;
const totalSections = 8;
let familiarRowCount = 1;

// Inicialización cuando se carga la página
document.addEventListener('DOMContentLoaded', function() {
    initializeForm();
    setupEventListeners();
    updateProgress();
    
    // Establecer fecha actual
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('fecha').value = today;
    
    // Cargar datos guardados si existen
    loadFormData();
});

// Configurar event listeners
function setupEventListeners() {
    // Navegación
    document.getElementById('prevBtn').addEventListener('click', previousSection);
    document.getElementById('nextBtn').addEventListener('click', nextSection);
    document.getElementById('generatePdfBtn').addEventListener('click', generatePDF);
    document.getElementById('clearFormBtn').addEventListener('click', clearForm);
    
    // Navegación por menú lateral
    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const sectionNumber = parseInt(this.dataset.section);
            goToSection(sectionNumber);
        });
    });
    
    // Toggle menú móvil
    document.getElementById('navToggle').addEventListener('click', function() {
        const navMenu = document.getElementById('navMenu');
        navMenu.classList.toggle('show');
    });
    
    // Cálculo automático de edad
    document.getElementById('fechaNacimiento').addEventListener('change', calculateAge);
    
    // Cálculo automático de IMC
    document.getElementById('peso').addEventListener('input', calculateIMC);
    document.getElementById('talla').addEventListener('input', calculateIMC);
    
    // Auto-guardado
    const formInputs = document.querySelectorAll('input, textarea, select');
    formInputs.forEach(input => {
        input.addEventListener('change', saveFormData);
        input.addEventListener('input', debounce(saveFormData, 1000));
    });
}

// Inicializar formulario
function initializeForm() {
    showSection(currentSection);
    updateNavigationButtons();
}

// Mostrar sección específica
function showSection(sectionNumber) {
    // Ocultar todas las secciones
    const sections = document.querySelectorAll('.form-section');
    sections.forEach(section => section.classList.remove('active'));
    
    // Mostrar sección actual
    const currentSectionElement = document.getElementById(`seccion${sectionNumber}`);
    if (currentSectionElement) {
        currentSectionElement.classList.add('active');
    }
    
    // Actualizar navegación lateral
    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
        link.classList.remove('active');
        if (parseInt(link.dataset.section) === sectionNumber) {
            link.classList.add('active');
        }
    });
    
    currentSection = sectionNumber;
    updateProgress();
    updateNavigationButtons();
    
    // Scroll al top
    document.querySelector('.form-content').scrollTop = 0;
}

// Ir a sección específica
function goToSection(sectionNumber) {
    if (sectionNumber >= 1 && sectionNumber <= totalSections) {
        showSection(sectionNumber);
    }
}

// Sección anterior
function previousSection() {
    if (currentSection > 1) {
        showSection(currentSection - 1);
    }
}

// Sección siguiente
function nextSection() {
    if (currentSection < totalSections) {
        showSection(currentSection + 1);
    }
}

// Actualizar botones de navegación
function updateNavigationButtons() {
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const generatePdfBtn = document.getElementById('generatePdfBtn');
    
    prevBtn.style.display = currentSection === 1 ? 'none' : 'inline-block';
    
    if (currentSection === totalSections) {
        nextBtn.style.display = 'none';
        generatePdfBtn.style.display = 'inline-block';
    } else {
        nextBtn.style.display = 'inline-block';
        generatePdfBtn.style.display = 'none';
    }
}

// Actualizar barra de progreso
function updateProgress() {
    const progressFill = document.getElementById('progressFill');
    const percentage = (currentSection / totalSections) * 100;
    progressFill.style.width = percentage + '%';
}

// Calcular edad automáticamente
function calculateAge() {
    const birthDate = new Date(this.value);
    const today = new Date();
    
    if (birthDate && birthDate <= today && !isNaN(birthDate.getTime())) {
        let age = today.getFullYear() - birthDate.getFullYear();
        const monthDiff = today.getMonth() - birthDate.getMonth();
        
        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
            age--;
        }
        
        document.getElementById('edad').value = age;
    } else {
        document.getElementById('edad').value = '';
    }
}

// Calcular IMC automáticamente
function calculateIMC() {
    const peso = parseFloat(document.getElementById('peso').value);
    const talla = parseFloat(document.getElementById('talla').value);
    
    if (peso && talla) {
        const tallaMts = talla / 100;
        const imc = peso / (tallaMts * tallaMts);
        document.getElementById('imc').value = imc.toFixed(2);
    }
}

// Agregar fila a tabla familiar
function addFamiliarRow() {
    familiarRowCount++;
    const tbody = document.getElementById('grupoFamiliarBody');
    const newRow = document.createElement('tr');
    
    newRow.innerHTML = `
        <td>${familiarRowCount}</td>
        <td><input type="text" name="familiar_nombre_${familiarRowCount}"></td>
        <td><input type="text" name="familiar_direccion_${familiarRowCount}"></td>
        <td><input type="tel" name="familiar_telefono_${familiarRowCount}"></td>
        <td><input type="text" name="familiar_referencia_${familiarRowCount}"></td>
        <td><button type="button" class="btn-remove" onclick="removeRow(this)">-</button></td>
    `;
    
    tbody.appendChild(newRow);
    
    // Agregar event listeners a los nuevos campos
    const newInputs = newRow.querySelectorAll('input');
    newInputs.forEach(input => {
        input.addEventListener('change', saveFormData);
        input.addEventListener('input', debounce(saveFormData, 1000));
    });
}

// Remover fila de tabla familiar
function removeRow(button) {
    const row = button.closest('tr');
    row.remove();
    
    // Reordenar números
    const rows = document.querySelectorAll('#grupoFamiliarBody tr');
    rows.forEach((row, index) => {
        row.cells[0].textContent = index + 1;
        
        // Actualizar nombres de los inputs
        const inputs = row.querySelectorAll('input');
        inputs[0].name = `familiar_nombre_${index + 1}`;
        inputs[1].name = `familiar_direccion_${index + 1}`;
        inputs[2].name = `familiar_telefono_${index + 1}`;
        inputs[3].name = `familiar_referencia_${index + 1}`;
    });
    
    familiarRowCount = rows.length;
}

// Guardar datos del formulario en localStorage
function saveFormData() {
    const formData = new FormData(document.getElementById('historiaClinicaForm'));
    const data = {};
    
    for (let [key, value] of formData.entries()) {
        data[key] = value;
    }
    
    // Guardar también datos de radio buttons y checkboxes
    const radioButtons = document.querySelectorAll('input[type="radio"]:checked');
    radioButtons.forEach(radio => {
        data[radio.name] = radio.value;
    });
    
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(checkbox => {
        data[checkbox.name] = checkbox.checked;
    });
    
    localStorage.setItem('historiaClinicaData', JSON.stringify(data));
}

// Cargar datos del formulario desde localStorage
function loadFormData() {
    const savedData = localStorage.getItem('historiaClinicaData');
    if (savedData) {
        const data = JSON.parse(savedData);
        
        for (let [key, value] of Object.entries(data)) {
            const field = document.querySelector(`[name="${key}"]`);
            if (field) {
                if (field.type === 'checkbox') {
                    field.checked = value;
                } else if (field.type === 'radio') {
                    if (field.value === value) {
                        field.checked = true;
                    }
                } else {
                    field.value = value;
                }
            }
        }
    }
}

// Generar PDF
function generatePDF() {
    try {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        // Configurar fuente
        doc.setFont('helvetica');
        
        let yPosition = 30;
        const pageHeight = doc.internal.pageSize.height;
        const marginLeft = 20;
        const marginRight = 20;
        const pageWidth = doc.internal.pageSize.width - marginLeft - marginRight;
        
        // Variable para controlar el número de página
        let pageNumber = 1;
        
        // Función para agregar nueva página si es necesario
        function checkPageBreak(neededSpace = 20) {
            if (yPosition + neededSpace > pageHeight - 40) {
                // Agregar numeración a la página actual antes de cambiar
                addPageNumber();
                doc.addPage();
                pageNumber++;
                yPosition = 30;
                // No agregar header en páginas nuevas
            }
        }
        
        // Función para agregar numeración de página
        function addPageNumber() {
            doc.setFontSize(10);
            doc.setTextColor('#666666');
            doc.setFont('helvetica', 'normal');
            doc.text(`Página ${pageNumber}`, doc.internal.pageSize.width / 2, pageHeight - 20, { align: 'center' });
        }
        
        // Función para agregar header simple
        function addSimpleHeader() {
            // Logo centrado
            const logoImg = document.getElementById('logoImage');
            if (logoImg && logoImg.complete) {
                // Crear canvas para convertir imagen a base64
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = logoImg.naturalWidth;
                canvas.height = logoImg.naturalHeight;
                ctx.drawImage(logoImg, 0, 0);
                const logoDataUrl = canvas.toDataURL('image/png');
                
                // Agregar logo centrado al PDF
                const logoWidth = 50;
                const logoHeight = (logoImg.naturalHeight / logoImg.naturalWidth) * logoWidth;
                const logoX = (doc.internal.pageSize.width - logoWidth) / 2;
                doc.addImage(logoDataUrl, 'PNG', logoX, yPosition, logoWidth, logoHeight);
                
                yPosition += logoHeight + 15; // Espacio después del logo
            }
            
            // Título del documento centrado
            doc.setFontSize(18);
            doc.setTextColor('#007bff');
            doc.setFont('helvetica', 'bold');
            const titleText = 'CUESTIONARIO DE EVALUACIÓN PEDAGÓGICA - RECREARTE';
            const titleWidth = doc.getTextWidth(titleText);
            const titleX = (doc.internal.pageSize.width - titleWidth) / 2;
            doc.text(titleText, titleX, yPosition);
            yPosition += 20;
            
            // Fecha como item separado
            const fecha = document.getElementById('fecha').value;
            doc.setFontSize(12);
            doc.setTextColor('#000000');
            doc.setFont('helvetica', 'normal');
            doc.text(`Fecha: ${fecha}`, marginLeft, yPosition);
            yPosition += 15;
            
            // Línea separadora
            doc.setDrawColor('#e9ecef');
            doc.line(marginLeft, yPosition, pageWidth, yPosition);
            
            yPosition += 20; // Más espacio antes del contenido
        }
        
        // Función para agregar sección
        function addSection(title, content) {
            checkPageBreak(30);
            
            // Título de sección
            doc.setFontSize(13);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor('#007bff');
            doc.text(title, marginLeft, yPosition);
            yPosition += 15;
            
            // Contenido
            doc.setTextColor('#000000');
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);
            
            if (typeof content === 'object') {
                Object.entries(content).forEach(([key, value]) => {
                    if (value) {
                        checkPageBreak();
                        const text = `${key}: ${value}`;
                        const lines = doc.splitTextToSize(text, pageWidth);
                        lines.forEach(line => {
                            doc.text(line, marginLeft, yPosition);
                            yPosition += 5;
                        });
                    }
                });
            } else if (content) {
                const lines = doc.splitTextToSize(content, pageWidth);
                lines.forEach(line => {
                    checkPageBreak();
                    doc.text(line, marginLeft, yPosition);
                    yPosition += 5;
                });
            }
            
            yPosition += 8;
        }
        
        // Agregar header inicial
        addSimpleHeader();
        
        // Recopilar datos del formulario
        const formData = new FormData(document.getElementById('historiaClinicaForm'));
        const data = {};
        for (let [key, value] of formData.entries()) {
            data[key] = value;
        }
        
        // Agregar secciones al PDF
        addSection('DATOS GENERALES DEL PARTICIPANTE', {
            'Nombre Completo': data.nombreCompleto,
            'Edad': data.edad,
            'Tipo de Discapacidad': data.tipoDiscapacidad,
            'Nivel de Autonomía': data.nivelAutonomia,
            'Apoyos Requeridos': data.apoyosRequeridos
        });
        
        addSection('ÁREA COGNITIVA', {
            'Reconoce instrucciones': data.reconoceInstrucciones,
            'Resuelve problemas': data.resuelveProblemas,
            'Relaciones lógicas': data.relacionesLogicas,
            'Observaciones': data.observacionesCognitivas
        });
        
        addSection('ÁREA SOCIAL Y EMOCIONAL', {
            'Interactúa con pares': data.interactuaPares,
            'Expresa emociones': data.expresaEmociones,
            'Respeta turnos': data.respetaTurnos,
            'Observaciones': data.observacionesSociales
        });
        
        addSection('ÁREA COMUNICACIONAL', {
            'Lenguaje verbal': data.lenguaje_verbal ? 'Sí' : 'No',
            'Lenguaje gestual': data.lenguaje_gestual ? 'Sí' : 'No',
            'Lenguaje pictográfico': data.lenguaje_pictografico ? 'Sí' : 'No',
            'Lenguaje asistido': data.lenguaje_asistido ? 'Sí' : 'No',
            'Comprende consignas': data.comprendeConsignas,
            'Comunica espontáneamente': data.comunicaEspontaneamente,
            'Observaciones': data.observacionesComunicacion
        });
        
        addSection('ÁREA CREATIVA Y EXPRESIVA', {
            'Participa en actividades artísticas': data.participaActividades,
            'Explora dibujos': data.explora_dibujos ? 'Sí' : 'No',
            'Explora música': data.explora_musica ? 'Sí' : 'No',
            'Explora teatro': data.explora_teatro ? 'Sí' : 'No',
            'Explora otros': data.explora_otros ? 'Sí' : 'No',
            'Interés creativo': data.interesCreativo,
            'Observaciones': data.observacionesCreativas
        });
        
        addSection('ÁREA MOTRIZ', {
            'Desplazamiento autónomo': data.desplazamientoAutonomo,
            'Coordinación de movimientos': data.coordinacionMovimientos,
            'Condición física limitante': data.condicionFisica,
            'Observaciones': data.observacionesMotrices
        });
        
        addSection('MOTIVACIÓN Y PARTICIPACIÓN', {
            'Involucramient en actividades': data.involucramientoActividades,
            'Acepta desafíos': data.aceptaDesafios,
            'Preferencia de espacios': data.preferenciaEspacios,
            'Observaciones': data.observacionesMotivacion
        });
        
        addSection('OBSERVACIONES GENERALES', {
            'Fortalezas observadas': data.fortalezasObservadas,
            'Aspectos a trabajar': data.aspectosTrabajar,
            'Recomendaciones específicas': data.recomendacionesEspecificas
        });
        
        // Firma
        checkPageBreak(30);
        doc.setFontSize(12);
        doc.setFont('helvetica', 'bold');
        doc.text('DOCENTE', pageWidth - 50, yPosition);
        
        // Leyenda al final
        checkPageBreak(40);
        yPosition += 30;
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor('#666666');
        const leyenda = 'RECREARTE - Centro Educativo Terapeutico - Funes - Santa Fe';
        const leyendaWidth = doc.getTextWidth(leyenda);
        const centeredX = (doc.internal.pageSize.width - leyendaWidth) / 2;
        doc.text(leyenda, centeredX, yPosition);
        
        // Agregar numeración a la última página
        addPageNumber();
        
        // Guardar PDF
        const nombreParticipante = data.nombreCompleto || 'Cuestionario_Pedagogico';
        const fechaFormateada = data.fecha || new Date().toISOString().split('T')[0];
        doc.save(`${nombreParticipante}_Evaluacion_Pedagogica_${fechaFormateada}.pdf`);
        
    } catch (error) {
        console.error('Error generando PDF:', error);
        alert('Error al generar el PDF. Por favor, intente nuevamente.');
    }
}

// Limpiar formulario
function clearForm() {
    if (confirm('¿Está seguro de que desea limpiar todo el formulario? Esta acción no se puede deshacer.')) {
        document.getElementById('historiaClinicaForm').reset();
        
        // Limpiar campos específicos
        document.getElementById('edad').value = '';
        document.getElementById('imc').value = '';
        
        // Limpiar tabla de grupo familiar (dejar solo una fila)
        const tbody = document.getElementById('grupoFamiliarBody');
        tbody.innerHTML = `
            <tr>
                <td>1</td>
                <td><input type="text" name="familiar_nombre_1"></td>
                <td><input type="text" name="familiar_direccion_1"></td>
                <td><input type="tel" name="familiar_telefono_1"></td>
                <td><input type="text" name="familiar_referencia_1"></td>
                <td><button type="button" class="btn-remove" onclick="removeRow(this)">-</button></td>
            </tr>
        `;
        familiarRowCount = 1;
        
        // Limpiar localStorage
        localStorage.removeItem('historiaClinicaData');
        
        // Establecer fecha actual
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('fecha').value = today;
        
        // Volver a la primera sección
        showSection(1);
        
        alert('Formulario limpiado correctamente. Puede comenzar una nueva historia clínica.');
    }
}

// Función debounce para optimizar auto-guardado
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}
    </script>
</body>
</html>

